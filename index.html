<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="./assets/css/main.css">
    <meta http-equiv="refresh" content=5>
  </head>
  <body>
    <script>
      
      $(document).ready(function(){
        var $body = $('body');
        // $body.html('');
        var $cacheTally = {};
        var $trendingTopic = '';

        var index = streams.home.length - 1;
        while(index >= 0){
          var tweet = streams.home[index];
          
          var $tweetText = $(`<div class="tweet-text"></div>`);
          $tweetText.text(tweet.message);

          var $trendCont = $(`<li class="trend-container-${index}"></li>`);
          var $trendContClass = `.trend-container-${index}`;

          var $tweetUser = $(`<p>@${tweet.user}</p>`);
          var $tweetCont = $(`<li class="tweet-container-${index}"></li>`);
          var $tweetContClass = `.tweet-container-${index}`;
          var $tweetTimeStamp = $(`<p>${streams.home[index].created_at}</p>`);
          var $pStand = $(`<p></p>`);

          $tweetCont.appendTo(".tweet-bar");

          
          $tweetUser.appendTo($tweetContClass);
          $tweetText.appendTo($tweetContClass);
          $tweetTimeStamp.appendTo($tweetContClass);
          
          $trendCont.appendTo(".trend-bar");

          if (tweet.message.indexOf('#') > -1) {
            $tweetUser.appendTo($trendContClass);

          } 
          
          $cacheTally = tweet.message.split(' ')
              .filter( item => item[0] === '#')
              .reduce( (accum, item) => {
                if (accum[item]) {
                  accum[item]++;
                } else {
                  accum[item] = 1;
                }
                return accum;
              },{})
              //#consult hack-reactor guide.
          
          $trendTopic = Object.entries($cacheTally).reduce( (accum, item) => {
            if (item[1]>accum) {
              accum = item[0];
            }
            return accum;
          },0);
          if ($trendTopic) {
            $pStand.text($trendTopic);
            $($pStand).appendTo($trendContClass);
          }
            
          index -= 1;
        }

      });
    </script>
    <section>
      <div class="row"><!--
        info bar 1
        --><section class="col-1-3">
          <ul class="list-bar">
          <li class="logo">
          </li>
          <li class="user-info">
            <div class=flex-5>
              <ul>
                <li class="twoof5">mario mui</li>
                <li class="threeof5">@mariomui</li>
              </ul>
            </div>
          </li>
          <li>
            <div class="half-circle"></div>
          </li>
        </ul>
        <ul class="trend-bar">
          
        </ul>
        </section><!--
          tweetbar
        --><section class="content col-2-3">
          <ul class="tweet-bar">
          </ul>
        </section><!--
          info2bar
        --><section class="col-1-3">
          <div class="info-bar">

          </div>   
        </section>
      </div>
    </section>
  </body>
</html>
